<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#f7d7df" />
  <title>Para mi vida üíó</title>

  <style>
    :root{
      --bg1:#fff6f7;
      --bg2:#fdecef;
      --card:#ffffffcc;
      --text:#2a1f24;
      --muted:#6a4d57;
      --accent:#e2557a;
      --accent2:#ff8fab;
      --cream:#fff2e6;
      --shadow: 0 18px 50px rgba(40, 10, 20, .10);
      --shadow2: 0 10px 24px rgba(40, 10, 20, .10);
      --radius: 22px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 900px at 15% 10%, var(--cream) 0%, transparent 55%),
        radial-gradient(1000px 800px at 90% 20%, #ffe6ef 0%, transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    a{color:inherit}
    .container{
      width:min(980px, 92vw);
      margin: 0 auto;
      padding: 22px 0 60px;
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding: 10px 14px;
      margin-top: 8px;
      border-radius: 999px;
      background: #ffffff70;
      backdrop-filter: blur(10px);
      box-shadow: 0 6px 18px rgba(40,10,20,.06);
      border: 1px solid rgba(226,85,122,.12);
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(226,85,122,.08);
      border: 1px solid rgba(226,85,122,.12);
      color: var(--muted);
      font-weight: 600;
      font-size: 12.5px;
      letter-spacing:.2px;
      white-space:nowrap;
    }
    .resetBtn{
      border: 1px solid rgba(226,85,122,.18);
      background: #ffffff75;
      backdrop-filter: blur(10px);
      color: var(--muted);
      font-weight: 700;
      padding: 9px 12px;
      border-radius: 999px;
      cursor:pointer;
      transition: transform .15s ease, background .15s ease;
    }
    .resetBtn:active{transform: scale(.98)}
    .resetBtn:hover{background:#fff}

    .hero{
      position:relative;
      margin-top: 18px;
      padding: 22px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, #ffffffb8, #ffffff80);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      border: 1px solid rgba(226,85,122,.14);
      overflow:hidden;
    }
    .hero::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(420px 320px at 20% 10%, rgba(226,85,122,.18), transparent 60%),
        radial-gradient(420px 320px at 90% 20%, rgba(255,143,171,.16), transparent 60%),
        radial-gradient(520px 420px at 30% 110%, rgba(255,242,230,.9), transparent 55%);
      pointer-events:none;
    }
    .heroInner{
      position:relative;
      display:grid;
      grid-template-columns: 1fr;
      gap: 18px;
      align-items:center;
    }

    h1{
      margin:0 0 10px;
      line-height:1.08;
      font-size: clamp(26px, 4.5vw, 44px);
      letter-spacing:-.6px;
    }
    .subtitle{
      margin:0 0 16px;
      color: var(--muted);
      font-size: clamp(14px, 2.8vw, 17px);
      line-height:1.5;
    }

    .counterCard{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 16px;
      background: #fff;
      box-shadow: var(--shadow2);
      border: 1px solid rgba(226,85,122,.12);
      width: fit-content;
      max-width: 100%;
    }
    .counterDot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 6px rgba(226,85,122,.10);
      flex: 0 0 auto;
    }
    .counterText{
      font-weight:800;
      letter-spacing:.2px;
      font-size: 14px;
    }

    .ctaWrap{
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      margin-top: 16px;
    }
    .btn{
      border: 0;
      padding: 13px 16px;
      border-radius: 16px;
      font-weight: 900;
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease, opacity .18s ease;
      font-size: 15px;
      min-width: 122px;
    }
    .btn:active{transform: translateY(1px) scale(.99)}
    .btnYes{
      background: linear-gradient(180deg, var(--accent), #d74c70);
      color: #fff;
      box-shadow: 0 12px 24px rgba(226,85,122,.28);
    }
    .btnYes:hover{box-shadow: 0 14px 30px rgba(226,85,122,.34)}
    .btnNo{
      background: #ffffffb8;
      color: var(--muted);
      border: 1px solid rgba(226,85,122,.20);
      box-shadow: 0 10px 20px rgba(40,10,20,.08);
      position:relative;
      touch-action: manipulation;
    }
    .btnNo:hover{background:#fff}

    .section{
      margin-top: 18px;
      padding: 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, #ffffffb0, #ffffff78);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(226,85,122,.12);
      box-shadow: var(--shadow2);
      opacity:0;
      transform: translateY(10px);
      transition: opacity .45s ease, transform .45s ease;
    }
    .section.show{opacity:1; transform: translateY(0)}
    .section h2{
      margin: 0 0 12px;
      font-size: 18px;
      letter-spacing:-.2px;
    }

    .loveList{
      list-style:none;
      padding:0;
      margin:0;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 520px){
      .loveList{grid-template-columns:1fr}
    }
    .loveItem{
      display:flex;
      gap: 10px;
      align-items:flex-start;
      padding: 12px;
      border-radius: 18px;
      background: #fff;
      border: 1px solid rgba(226,85,122,.10);
      box-shadow: 0 8px 16px rgba(40,10,20,.06);
    }
    .heartIcon{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      background: rgba(226,85,122,.10);
      display:grid;
      place-items:center;
      font-size: 16px;
      flex: 0 0 auto;
    }
    .loveItem span{
      font-weight: 750;
      color: var(--text);
      line-height:1.2;
      margin-top: 3px;
    }

    .gallery{
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
    }
    @media (max-width: 880px){
      .gallery{grid-template-columns: repeat(3, 1fr);}
    }
    @media (max-width: 520px){
      .gallery{grid-template-columns: repeat(2, 1fr);}
    }
    .photo{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      aspect-ratio: 1 / 1;
      cursor:pointer;
      background: linear-gradient(135deg, rgba(255,143,171,.22), rgba(226,85,122,.12));
      border: 1px solid rgba(226,85,122,.12);
      box-shadow: 0 10px 20px rgba(40,10,20,.08);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .photo:hover{transform: translateY(-2px); box-shadow: 0 14px 28px rgba(40,10,20,.10)}
    .photo img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .photo .phOverlay{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      color: rgba(255,255,255,.92);
      font-weight: 900;
      text-shadow: 0 8px 26px rgba(0,0,0,.25);
      background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,.25) 120%);
      opacity: .25;
      transition: opacity .18s ease;
      font-size: 14px;
      letter-spacing:.2px;
    }
    .photo:hover .phOverlay{opacity:.12}

    .modal{
      position:fixed;
      inset:0;
      background: rgba(10, 5, 8, .55);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 50;
    }
    .modal.show{display:flex}
    .modalCard{
      width:min(980px, 92vw);
      background: #ffffff;
      border-radius: 22px;
      overflow:hidden;
      box-shadow: 0 30px 80px rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.15);
    }
    .modalTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding: 12px 14px;
      background: linear-gradient(180deg, #fff, #fff6f7);
      border-bottom: 1px solid rgba(226,85,122,.10);
    }
    .modalTop strong{font-size: 14px; color: var(--muted)}
    .closeBtn{
      border: 0;
      background: rgba(226,85,122,.10);
      color: var(--muted);
      font-weight: 900;
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
    }
    .modalImg{
      width:100%;
      height: min(72vh, 620px);
      object-fit: contain;
      background: #111;
      display:block;
    }

    .finalText{
      margin:0;
      color: var(--muted);
      line-height: 1.7;
      font-size: 15px;
    }
    .finalText strong{color: var(--text)}

    /* -------------------------
       CARTA + ANIMACI√ìN MEJORADA
       ------------------------- */
    .letterWrap{
      display:none;
      margin-top: 14px;
      transform-origin: top;
    }
    .letterWrap.show{display:block}

    .envelope{
      position:relative;
      border-radius: 22px;
      overflow:hidden;
      background: linear-gradient(180deg, #fff, #fff6f7);
      border: 1px solid rgba(226,85,122,.14);
      box-shadow: var(--shadow);
      transform: translateY(0) scale(1);
      transition: transform .35s cubic-bezier(.2,.9,.2,1);
      will-change: transform;
    }

    .envTop{
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      background: linear-gradient(180deg, rgba(226,85,122,.10), rgba(255,255,255,.0));
      position:relative;
      z-index: 3;
    }
    .envTop .title{
      font-weight: 950;
      letter-spacing:.2px;
    }

    .stamp{
      font-size: 18px;
      padding: 8px 10px;
      border-radius: 14px;
      background: rgba(226,85,122,.10);
      border: 1px dashed rgba(226,85,122,.28);
      transform: rotate(-4deg) scale(1);
      transition: transform .35s cubic-bezier(.2,.9,.2,1), filter .35s ease;
      filter: saturate(1.05);
    }

    .envGlow{
      content:"";
      position:absolute;
      inset:-2px;
      pointer-events:none;
      background:
        radial-gradient(420px 260px at 18% 10%, rgba(226,85,122,.16), transparent 60%),
        radial-gradient(520px 320px at 90% 0%, rgba(255,143,171,.12), transparent 60%);
      opacity:.0;
      transition: opacity .45s ease;
      z-index: 1;
    }

    .flap{
      position:relative;
      height: 78px;
      background: linear-gradient(180deg, rgba(255,143,171,.22), rgba(226,85,122,.12));
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      transform-origin: top;
      transform: perspective(900px) rotateX(0deg);
      transition: transform .9s cubic-bezier(.2,.9,.2,1);
      border-bottom: 1px solid rgba(226,85,122,.10);
      z-index: 2;
    }

    .letter{
      padding: 14px 16px 18px;
      transform: translateY(-26px) scale(.98);
      opacity: 0;
      transition: transform .85s cubic-bezier(.2,.9,.2,1), opacity .55s ease;
      position:relative;
      z-index: 2;
    }

    .envelope.open{
      animation: envPop .65s cubic-bezier(.2,.9,.2,1) both;
    }
    .envelope.open .envGlow{ opacity: 1; }
    .envelope.open .flap{
      transform: perspective(900px) rotateX(180deg);
    }
    .envelope.open .stamp{
      transform: rotate(-8deg) scale(1.06);
      filter: saturate(1.2) drop-shadow(0 10px 18px rgba(226,85,122,.20));
    }
    .envelope.open .letter{
      opacity: 1;
      transform: translateY(0) scale(1);
      animation: letterRise .9s cubic-bezier(.2,.9,.2,1) both;
    }

    @keyframes envPop{
      0%{ transform: translateY(6px) scale(.985); }
      55%{ transform: translateY(-2px) scale(1.01); }
      100%{ transform: translateY(0) scale(1); }
    }
    @keyframes letterRise{
      0%{ transform: translateY(16px) scale(.985); }
      55%{ transform: translateY(-4px) scale(1.01); }
      100%{ transform: translateY(0) scale(1); }
    }

    /* -------------------------
       CUPONES (VOLVER A LOS ANTERIORES)
       ------------------------- */
    .coupons{
      margin-top: 10px;
      display:grid;
      gap: 10px;
    }
    .coupon{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 12px;
      border-radius: 18px;
      background: #fff;
      border: 1px solid rgba(226,85,122,.12);
      box-shadow: 0 10px 18px rgba(40,10,20,.06);
    }
    .coupon .left{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width:0;
    }
    .ticket{
      width: 36px;
      height: 36px;
      border-radius: 14px;
      background: rgba(226,85,122,.10);
      display:grid;
      place-items:center;
      font-size: 16px;
      flex: 0 0 auto;
    }
    .coupon .name{
      font-weight: 950;
      letter-spacing:.1px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .coupon .tag{
      font-size: 12px;
      font-weight: 850;
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,143,171,.14);
      border: 1px solid rgba(226,85,122,.12);
      flex: 0 0 auto;
      white-space:nowrap;
    }

    .hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 0;
      overflow:hidden;
    }
    .heart{
      position:absolute;
      width: 14px;
      height: 14px;
      transform: rotate(45deg);
      opacity: .22;
      animation: floatUp linear forwards;
      filter: blur(.1px);
    }
    .heart:before, .heart:after{
      content:"";
      position:absolute;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: currentColor;
      top: -7px;
      left: 0;
    }
    .heart:after{
      left: -7px;
      top: 0;
    }
    @keyframes floatUp{
      from{transform: translateY(0) rotate(45deg) scale(.9); opacity:.18}
      20%{opacity:.26}
      to{transform: translateY(-120vh) rotate(45deg) scale(1.25); opacity:0}
    }

    .tiny{
      font-size: 12px;
      color: rgba(106,77,87,.9);
      margin: 10px 0 0;
      line-height:1.5;
    }

    :focus-visible{
      outline: 3px solid rgba(226,85,122,.35);
      outline-offset: 3px;
      border-radius: 14px;
    }
  </style>
</head>

<body>
  <div class="hearts" aria-hidden="true" id="heartsLayer"></div>

  <div class="container" style="position:relative; z-index:1;">
    <div class="topbar">
      <div class="badge" id="daysBadge">üíó Llevamos <span id="daysTogether">‚Äî</span> d√≠as juntos</div>
      <button class="resetBtn" id="resetBtn" type="button">Reiniciar ‚Ü∫</button>
    </div>

    <header class="hero" id="hero">
      <div class="heroInner">
        <div>
          <h1>Camila (mi vida), ¬øquieres ser mi San Valent√≠n?</h1>
          <p class="subtitle">Tengo una mini sorpresa hecha con amor (y un poco de c√≥digo).</p>

          <div class="counterCard" role="status" aria-live="polite">
            <div class="counterDot" aria-hidden="true"></div>
            <div class="counterText" id="counterText">Llevamos ‚Äî d√≠as juntos üíó</div>
          </div>

          <div class="ctaWrap" id="ctaWrap">
            <button class="btn btnYes" id="btnYes" type="button">S√≠ üíò</button>
            <button class="btn btnNo" id="btnNo" type="button" aria-disabled="false">No üôà</button>
          </div>

          <p class="tiny">
            Hecho para ti, <strong>mi vida</strong>. Si presionas ‚ÄúS√≠‚Äù, se abre una cartita con una sorpresa ‚ú®
          </p>

          <div class="letterWrap" id="letterWrap" aria-live="polite">
            <div class="envelope" id="envelope">
              <div class="envGlow" aria-hidden="true"></div>

              <div class="envTop">
                <div class="title">Para mi vida üíå</div>
                <div class="stamp" aria-hidden="true">üíó</div>
              </div>

              <div class="flap" aria-hidden="true"></div>

              <div class="letter">
                <p style="margin:0 0 10px; color: var(--muted); line-height:1.6;">
                  Princesa‚Ä¶ gracias por ser t√∫. Aqu√≠ van <strong>5 cupones</strong> que puedes canjear cuando quieras üíû
                </p>

                <div class="coupons" id="coupons"></div>

                <p class="tiny" style="margin-top: 12px;">
                  PD: Te amo <strong>mi vida</strong>. Siempre.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- ‚úÖ Eliminado: ‚ÄúDetalles de amor (y c√≥digo)‚Äù -->
      </div>
    </header>

    <section class="section" id="secLove">
      <h2>Cosas que amo de ti üíû</h2>
      <ul class="loveList">
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tus ojos</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tu risa</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tu forma de tratarme</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>como me miras</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tus besos</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tu pelo</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>tu forma de amarme</span></li>
        <li class="loveItem"><div class="heartIcon">üíó</div><span>me encanta cada detalle de ti amor de mi vida</span></li>
      </ul>
    </section>

    <section class="section" id="secGallery">
      <h2>Nuestros momentos üì∏</h2>
      <p class="subtitle" style="margin-top:-4px;">
        (Toca una foto para verla grande, mi vida)
      </p>

      <div class="gallery" id="gallery"></div>

      <p class="tiny">
        EDITABLE: reemplaza las rutas <code>1.jpg</code>‚Ä¶<code>10.jpg</code> por tus fotos reales.
      </p>
    </section>

    <section class="section" id="secFinal">
      <h2>Para ti, mi vida üåô</h2>
      <p class="finalText">
        <strong>Gracias por elegirme d√≠a a d√≠a</strong>. Cada cosa contigo se siente m√°s bonita, m√°s real, m√°s nuestra.
        Gracias por estos meses, por tu amor, por tu forma de mirarme y quedarte.
        <br><br>
        <strong>Te amo</strong>, eres el amor de mi vida y te quiero siempre a mi lado, <strong>amor</strong>.
        Mi <strong>princesa</strong>, yo te elijo hoy y siempre. üíó
      </p>
    </section>
  </div>

  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Foto">
    <div class="modalCard">
      <div class="modalTop">
        <strong id="modalLabel">Foto</strong>
        <button class="closeBtn" id="closeModal" type="button">Cerrar ‚úï</button>
      </div>
      <img class="modalImg" id="modalImg" alt="Foto grande" />
    </div>
  </div>

  <script>
    const START_DATE = new Date(2025, 4, 10, 0, 0, 0);
    const PHOTOS = Array.from({ length: 10 }, (_, i) => `${i+1}.jpg`);

    // ‚úÖ VUELTA a los cupones anteriores
    const COUPONS = [
      { icon: "üçù", text: "Cup√≥n v√°lido para ir a cenar", tag: "Yo invito üíò" },
      { icon: "üèñÔ∏è", text: "Cup√≥n v√°lido para ir a la playa", tag: "Escape juntos üåä" },
      { icon: "üé¨", text: "Cup√≥n v√°lido para ir al cine", tag: "Palomitas üçø" },
      { icon: "üìΩÔ∏è", text: "Cup√≥n v√°lido para noche de pel√≠culas", tag: "Pijama time üò¥" },
      { icon: "üõèÔ∏è", text: "Cup√≥n v√°lido para dormir juntos", tag: "Abrazos ü•∞" },
    ];

    const NO_TEXTS = [
      "No üôà",
      "¬øSegura, princesa? üëÄ",
      "Pi√©nsalo mi vida üò≥",
      "Amor‚Ä¶ ¬øde verdad? ü•∫",
      "Ya po‚Ä¶ di que s√≠ üòº",
      "Te hago ojitos üòè",
      "√öltima oportunidad üò≠",
      "Ok‚Ä¶ pero te amo igual üíó"
    ];

    const $ = (id) => document.getElementById(id);

    function daysTogether(){
      const now = new Date();
      const diffMs = now - START_DATE;
      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
      return Math.max(0, diffDays);
    }

    function setCounter(){
      const d = daysTogether();
      $("daysTogether").textContent = d.toString();
      $("counterText").textContent = `Llevamos ${d} d√≠as juntos üíó`;
      $("daysBadge").setAttribute("aria-label", `Llevamos ${d} d√≠as juntos`);
    }

    const observer = new IntersectionObserver((entries)=>{
      for(const e of entries){
        if(e.isIntersecting) e.target.classList.add("show");
      }
    }, { threshold: 0.12 });

    ["secLove","secGallery","secFinal"].forEach(id => observer.observe($(id)));

    const gallery = $("gallery");
    const modal = $("modal");
    const modalImg = $("modalImg");
    const modalLabel = $("modalLabel");
    const closeModal = $("closeModal");

    function buildGallery(){
      gallery.innerHTML = "";
      PHOTOS.forEach((src, idx)=>{
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "photo";
        btn.setAttribute("aria-label", `Abrir foto ${idx+1}`);

        const img = document.createElement("img");
        img.alt = `Foto ${idx+1}`;
        img.loading = "lazy";
        img.src = src;

        img.onerror = () => {
          img.remove();
          const overlay = document.createElement("div");
          overlay.className = "phOverlay";
          overlay.textContent = `Foto ${idx+1}`;
          btn.appendChild(overlay);
        };

        btn.appendChild(img);

        const overlay = document.createElement("div");
        overlay.className = "phOverlay";
        overlay.textContent = `Foto ${idx+1}`;
        btn.appendChild(overlay);

        btn.addEventListener("click", ()=>{
          openModal(src, idx+1);
        });

        gallery.appendChild(btn);
      });
    }

    function openModal(src, n){
      modalLabel.textContent = `Foto ${n}`;
      modalImg.src = src;
      modal.classList.add("show");
      closeModal.focus();
      document.body.style.overflow = "hidden";
    }
    function hideModal(){
      modal.classList.remove("show");
      modalImg.src = "";
      document.body.style.overflow = "";
    }
    modal.addEventListener("click", (e)=>{
      if(e.target === modal) hideModal();
    });
    closeModal.addEventListener("click", hideModal);
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape" && modal.classList.contains("show")) hideModal();
    });

    const couponsEl = $("coupons");
    const letterWrap = $("letterWrap");
    const envelope = $("envelope");

    function buildCoupons(){
      couponsEl.innerHTML = "";
      COUPONS.forEach((c)=>{
        const row = document.createElement("div");
        row.className = "coupon";
        row.innerHTML = `
          <div class="left">
            <div class="ticket" aria-hidden="true">${c.icon}</div>
            <div class="name">${c.text}</div>
          </div>
          <div class="tag">${c.tag}</div>
        `;
        couponsEl.appendChild(row);
      });
    }

    function openLetter(){
      letterWrap.classList.add("show");
      requestAnimationFrame(()=>{
        setTimeout(()=> envelope.classList.add("open"), 80);
      });
      setTimeout(()=> letterWrap.scrollIntoView({ behavior:"smooth", block:"start" }), 260);
    }

    function closeLetter(){
      envelope.classList.remove("open");
      setTimeout(()=> letterWrap.classList.remove("show"), 260);
    }

    const btnYes = $("btnYes");
    const btnNo = $("btnNo");

    let noIndex = 0;
    let noMoveCount = 0;

    function moveNoButton(){
      const maxX = 90;
      const maxY = 32;
      const damp = Math.max(0.35, 1 - (noMoveCount * 0.12));
      const dx = (Math.random() * 2 - 1) * maxX * damp;
      const dy = (Math.random() * 2 - 1) * maxY * damp;
      btnNo.style.transform = `translate(${dx}px, ${dy}px)`;
      noMoveCount++;
    }

    function changeNoText(){
      noIndex = (noIndex + 1) % NO_TEXTS.length;
      btnNo.textContent = NO_TEXTS[noIndex];
    }

    function resetNoButton(){
      btnNo.style.transform = "";
      btnNo.textContent = "No üôà";
      noIndex = 0;
      noMoveCount = 0;
    }

    btnYes.addEventListener("click", ()=>{
      btnYes.disabled = true;
      btnNo.disabled = true;
      btnYes.style.opacity = ".92";
      btnNo.style.opacity = ".92";
      openLetter();
      burstHearts(22);
    });

    const playfulNo = ()=>{
      if(btnNo.disabled) return;
      changeNoText();
      moveNoButton();
      burstHearts(6);
    };

    btnNo.addEventListener("mouseenter", playfulNo);
    btnNo.addEventListener("touchstart", (e)=>{ e.preventDefault(); playfulNo(); }, { passive:false });
    btnNo.addEventListener("click", playfulNo);

    const heartsLayer = $("heartsLayer");
    let heartsInterval = null;

    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const left = Math.random() * 100;
      const size = 10 + Math.random() * 12;
      const duration = 6 + Math.random() * 6;
      const delay = Math.random() * 1.2;

      const colors = ["rgba(226,85,122,.9)", "rgba(255,143,171,.9)", "rgba(240,120,150,.9)", "rgba(255,170,190,.9)"];
      h.style.color = colors[Math.floor(Math.random() * colors.length)];

      h.style.left = left + "vw";
      h.style.bottom = (-20 - Math.random() * 40) + "px";
      h.style.width = size + "px";
      h.style.height = size + "px";
      h.style.animationDuration = duration + "s";
      h.style.animationDelay = delay + "s";

      heartsLayer.appendChild(h);
      setTimeout(()=> h.remove(), (duration + delay) * 1000 + 200);
    }

    function startHearts(){
      if(heartsInterval) return;
      heartsInterval = setInterval(spawnHeart, 520);
      for(let i=0;i<10;i++) spawnHeart();
    }

    function burstHearts(n=10){
      for(let i=0;i<n;i++){
        setTimeout(spawnHeart, i * 35);
      }
    }

    $("resetBtn").addEventListener("click", ()=>{
      btnYes.disabled = false;
      btnNo.disabled = false;
      btnYes.style.opacity = "";
      btnNo.style.opacity = "";
      closeLetter();
      resetNoButton();
      if(modal.classList.contains("show")) hideModal();
      window.scrollTo({ top: 0, behavior: "smooth" });
      burstHearts(10);
    });

    setCounter();
    buildGallery();
    buildCoupons();
    startHearts();
    setInterval(setCounter, 60 * 1000);
  </script>
</body>
</html>
